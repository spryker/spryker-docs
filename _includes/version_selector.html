{% assign current_version = page.version | default: site.version %}
{% assign current_version_label = site.versions[current_version] | default: 'undefined' %}

{% assign total_versions = site.versions | size %}
{% if total_versions > 1 %}

  {%- comment -%}
  Replace current version (in URL) with selected version
  {%- endcomment -%}
  {% assign base_url = page.url | replace: '/' | replace: current_version, 'VERSION_PLACEHOLDER' %}

  <div class="alt-nav dropdown">
    <span class="alt-nav__opener nav-link dropdown-toggle" id="versionDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="alt-nav__opener-text">{{ current_version_label }}</span>
      <i class="alt-nav__opener-icon icon-arrow-down"></i>
    </span>
    <span class="alt-nav__opener-label">Versions</span>
    <ul class="alt-nav__drop dropdown-menu" aria-labelledby="versionDropdownMenuLink">
      {% for version_pair in site.versions %}
        {% assign version_key = version_pair[0] %}
        {% assign version_label = version_pair[1] %}
        {% assign new_url = page.url | replace: current_version, version_key %}
        <li>
          <a href="{{ site.baseurl }}{{ new_url }}">{{ version_label }}</a>
        </li>
      {% endfor %}
    </ul>
  </div>
  <div class="alt-nav__overlay"></div>
{% else %}
  <div class="alt-nav">
    <span class="alt-nav__opener">This document has only one version {{ current_version_label }}</span>
  </div>
{% endif %}
