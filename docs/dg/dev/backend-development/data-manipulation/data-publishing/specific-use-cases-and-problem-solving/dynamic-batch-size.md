---
title: Dynamic batch size
description: Optimize large data imports with dynamic batch sizing to manage memory efficiently, prevent overload, and ensure stable, reliable processing during high-volume operations.
last_updated: Jun 16, 2025
template: howto-guide-template
related:
  - title: RAM-aware batch processing
    link: docs/dg/dev/guidelines/performance-guidelines/elastic-computing/ram-aware-batch-processing
  - title: Integrate RAM-aware batch processing
    link: docs/dg/dev/integrate-and-configure/integrate-elastic-computing.html#integrate-ram-aware-batch-processing
    
---

During large-scale data imports - such as loading customer orders, product details, and pricing data - the process can take several hours and consume significant system memory. This may lead to memory exhaustion, application crashes, or degraded performance.

Moreover, memory usage is often uneven, with spikes of high consumption followed by low-usage periods. To address these challenges, you can implement a dynamic batch size strategy.

This approach continuously adjusts the batch size based on the available memory for the current thread. As a result, it helps to achieve the following:

- Optimize memory utilization

- Prevent memory overload

- Ensure a more stable and efficient import process

By dynamically adapting to the system's capacity, this method improves reliability and makes large imports more predictable and resource-friendly.

<!-- draw.io diagram -->
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;dark-mode&quot;:&quot;auto&quot;,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;ac.draw.io\&quot; agent=\&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36\&quot; version=\&quot;28.2.3\&quot;&gt;\n  &lt;diagram id=\&quot;sOfpHPnipTytGIVyCLze\&quot; name=\&quot;Page-1\&quot;&gt;\n    &lt;mxGraphModel dx=\&quot;412\&quot; dy=\&quot;-3492\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;827\&quot; pageHeight=\&quot;1169\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;\n      &lt;root&gt;\n        &lt;mxCell id=\&quot;0\&quot; /&gt;\n        &lt;mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot; /&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1668\&quot; y=\&quot;4840\&quot; width=\&quot;805\&quot; height=\&quot;350\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-1\&quot; value=\&quot;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;strokeColor=#33CCA6;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry width=\&quot;804.9999999999999\&quot; height=\&quot;349.99999999999994\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-3\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 11px;&amp;quot;&amp;gt;Data Write&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;font style=&amp;quot;font-size: 10px;&amp;quot;&amp;gt;Based on Available Memory&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#33CCA6;strokeColor=none;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;425.83333333333326\&quot; y=\&quot;244.99999999999997\&quot; width=\&quot;206.51166666666663\&quot; height=\&quot;58.33333333333332\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-4\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endArrow=classicThin;endFill=1;exitX=0.992;exitY=0.38;exitDx=0;exitDy=0;exitPerimeter=0;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; source=\&quot;QaQ2qSR3QIp7UgtG7mTb-9\&quot; target=\&quot;QaQ2qSR3QIp7UgtG7mTb-3\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;408.6833333333335\&quot; y=\&quot;274.16666666666663\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-5\&quot; value=\&quot;&amp;lt;font size=&amp;quot;1&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;MemoryAllocatedElasticBatch&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;140\&quot; y=\&quot;140\&quot; width=\&quot;256.66666666666663\&quot; height=\&quot;46.53833333333333\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-6\&quot; value=\&quot;\&quot; style=\&quot;group\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; connectable=\&quot;0\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;220.1033333333334\&quot; y=\&quot;246.6449999999998\&quot; width=\&quot;99.02666666666664\&quot; height=\&quot;59.709999999999994\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-7\&quot; value=\&quot;\&quot; style=\&quot;shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fillColor=#dae8fc;strokeColor=#6c8ebf;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-6\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry width=\&quot;90.4353120243531\&quot; height=\&quot;51.71935902988312\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-8\&quot; value=\&quot;\&quot; style=\&quot;shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fillColor=#dae8fc;strokeColor=#6c8ebf;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-6\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;4.069589041095872\&quot; y=\&quot;4.111689042875643\&quot; width=\&quot;90.4353120243531\&quot; height=\&quot;51.71935902988312\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-9\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 9px;&amp;quot;&amp;gt;Steps Broker&amp;lt;/font&amp;gt;\&quot; style=\&quot;shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fillColor=#dae8fc;strokeColor=#6c8ebf;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-6\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;8.59135464231353\&quot; y=\&quot;7.9906409701168775\&quot; width=\&quot;90.4353120243531\&quot; height=\&quot;51.71935902988312\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-2\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classicThin;endFill=1;startArrow=classicThin;startFill=1;dashed=1;entryX=0.541;entryY=0.003;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; source=\&quot;QaQ2qSR3QIp7UgtG7mTb-5\&quot; target=\&quot;QaQ2qSR3QIp7UgtG7mTb-7\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;269.12365591397776\&quot; y=\&quot;198.2049999999993\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n            &lt;mxPoint x=\&quot;269.5\&quot; y=\&quot;244.99999999999997\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-10\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; source=\&quot;QaQ2qSR3QIp7UgtG7mTb-11\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;220.49999999999997\&quot; y=\&quot;274.16666666666663\&quot; as=\&quot;targetPoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-11\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 8px;&amp;quot;&amp;gt;Queue Data Reader&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=8;fillColor=#33CCA6;strokeColor=none;fontColor=#000000;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;16.356666666666644\&quot; y=\&quot;250.8333333333333\&quot; width=\&quot;128.33333333333331\&quot; height=\&quot;46.66666666666666\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-12\&quot; value=\&quot;&amp;lt;font face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b&amp;gt;BulkWriteGradualityFactor&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;font style=&amp;quot;font-size: 10px;&amp;quot;&amp;gt;Estimate an Upper-Limit of Memory&amp;lt;/font&amp;gt;&amp;lt;font style=&amp;quot;border-color: var(--border-color);&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;border-color: var(--border-color);&amp;quot;&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;447.5333333333332\&quot; y=\&quot;23.33333333333333\&quot; width=\&quot;287.46666666666664\&quot; height=\&quot;46.66666666666666\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-13\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;dashed=1;endArrow=classicThin;endFill=1;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; source=\&quot;QaQ2qSR3QIp7UgtG7mTb-14\&quot; target=\&quot;QaQ2qSR3QIp7UgtG7mTb-5\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-14\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-weight: bold;&amp;quot; face=&amp;quot;Courier New&amp;quot;&amp;gt;BulkWriteMemoryThresholdPercent&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;font style=&amp;quot;border-color: var(--border-color); font-size: 10px;&amp;quot; face=&amp;quot;Helvetica&amp;quot;&amp;gt;Define a Margin PHP Memory&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;446.8216666666664\&quot; y=\&quot;81.7949999999996\&quot; width=\&quot;288.1783333333333\&quot; height=\&quot;46.53833333333333\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-15\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.636;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;endArrow=classicThin;endFill=1;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; source=\&quot;QaQ2qSR3QIp7UgtG7mTb-12\&quot; target=\&quot;QaQ2qSR3QIp7UgtG7mTb-5\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-16\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 10px;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;font style=&amp;quot;font-size: 10px;&amp;quot;&amp;gt;Database&amp;lt;/font&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;strokeWidth=2;html=1;shape=mxgraph.flowchart.database;whiteSpace=wrap;fillColor=#33CCA6;strokeColor=#FFFFFF;fontColor=#000000;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;699.0023773805198\&quot; y=\&quot;226.89606175997503\&quot; width=\&quot;74.48249035049413\&quot; height=\&quot;94.5351927643879\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;QaQ2qSR3QIp7UgtG7mTb-17\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classicThin;endFill=1;\&quot; parent=\&quot;QaQ2qSR3QIp7UgtG7mTb-18\&quot; source=\&quot;QaQ2qSR3QIp7UgtG7mTb-3\&quot; target=\&quot;QaQ2qSR3QIp7UgtG7mTb-16\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n      &lt;/root&gt;\n    &lt;/mxGraphModel&gt;\n  &lt;/diagram&gt;\n&lt;/mxfile&gt;\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>


For more information, see [RAM-aware batch processing](/docs/dg/dev/guidelines/performance-guidelines/elastic-computing/ram-aware-batch-processing) and [Integrate RAM-aware batch processing](/docs/dg/dev/integrate-and-configure/integrate-elastic-computing.html#integrate-ram-aware-batch-processing).



